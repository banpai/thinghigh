var left=new Vue({el:"#left",data:{percent:0,level:[]}}),right=new Vue({el:"#right",data:{buttons:[]},methods:{cgmk:function(t){app.model=t,"task"===t&&portsfun.gettask(),app.code_id=null,app.codecontent="#没有代码",app.codesearch="",app.code_flag=!0}}}),app=new Vue({el:"#app",data:{codecontent:"#没有代码",code_type:"",code_id:"",code_title:"",code_flag:!0,tasksearch:"",task_id:null,visible:!1,jilian:!1,write_val:"1",write_name:"",write:"",model:"task",codesearch:"",taskli:[],taskliok:[],codename:[]},filters:{marked:marked},methods:{update:function(t){this.input=t.target.value},change:function(t){this.jilian=t},show:function(){this.visible=!0},getcn:function(t){alert(t)},task_enter:function(){var t=this;t.tasksearch.length>0?portsfun.puttask(t.tasksearch,function(){portsfun.gettask()}):t.$Message.warning("请填写内容")},task_ok:function(t,e){portsfun.oktask(t,e,function(){portsfun.gettask()})},task_change:function(t,e){this.tasksearch=e,this.task_id=t},task_remove:function(t){portsfun.deltask(t,function(){portsfun.gettask()})},format:function(t,e){var a=t.length-1,n=e[a]||!1;return n&&n.code?(this.codesearch!==n.code&&this.code_flag&&(portsfun.getcode(n.value,"2"),this.codesearch=n.label),t[a]):void 0},code_chang:function(){this.write=this.codecontent,this.write_val=this.code_type,this.write_name=this.code_title,this.model="write"},code_add:function(){this.model="write",this.code_id=null,this.codecontent="#没有代码",this.codesearch="",this.code_flag=!0},code_delete:function(){if(this.code_id){var t=this;portsfun.delcode({id:t.code_id,callback:function(){t.code_id=null,t.codesearch="",t.code_flag=!1,t.codecontent="#没有代码",t.model="write",t.model="code",portsfun.getcodename(),t.$Message.success("删除成功")}})}else this.$Message.error("请选择代码片段")},write_sub:function(){if(this.write_name)if(this.write){var t=this;this.$Modal.confirm({title:"确定要提交到代码库吗？",loading:!0,content:"提交的代码片段可以在代码库模块中查询……",onOk:function(){portsfun.putcode({code_id:t.code_id,write:t.write,write_val:t.write_val,write_name:t.write_name,callback:function(){t.$Modal.remove(),t.write="",t.write_val="1",t.write_name="",portsfun.getcodename(),t.$Message.success("提交成功"),t.model="code",t.code_id=null,t.codecontent="#没有代码",t.codesearch="",t.code_flag=!0}})}})}else this.$Message.error("请填写内容");else this.$Message.error("请填写名称")}}}),portsfun=function(){var t=function(t){ajax("index-putcode.html",{id:t.code_id,type:t.write_val,content:t.write,title:t.write_name},function(e){"0"===e.errcode?t.callback():this.$Message.error(e.errmsg)})},e=function(t){ajax("index-delcode.html",{id:t.id},function(){t.callback()})},a=function(){ajax("index-codename.html",{},function(t){app.codename=t.data})},n=function(){ajax("/js/data/buttons.json",{},function(t){right.buttons=t.data})},o=function(){ajax("index-level.html",{},function(t){left.level=t.data})},i=function(t,e){ajax("index-code.html",{id:t,flag:e},function(t){app.codecontent=t.data[0].content,app.code_type=t.data[0].type,app.code_id=t.data[0].id,app.code_title=t.data[0].title,$("pre code").each(function(t,e){hljs.highlightBlock(e)})})},c=function(t,e){ajax("index-puttask.html",{name:t,id:app.task_id},function(){app.task_id=null,e()})},s=function(){ajax("index-gettask.html",{},function(t){app.taskli=[],app.taskliok=[],$.each(t.date,function(t,e){"0"===e.state?app.taskli.push(e):app.taskliok.push(e)}),app.tasksearch=""})},d=function(t,e,a){ajax("index-oktask.html",{id:t,state:e},function(t){a(t)})},l=function(t,e){ajax("index-deltask.html",{id:t},function(t){e(t)})};return{getbuttonsdata:n,getleveldata:o,getcode:i,getcodename:a,putcode:t,delcode:e,puttask:c,gettask:s,oktask:d,deltask:l}}();window.onload=function(){$("#left").show(),$("#right").show(),$("#app").show(),portsfun.gettask(),portsfun.getbuttonsdata(),portsfun.getleveldata(),portsfun.getcodename(),hljs.initHighlightingOnLoad()};