var left=new Vue({el:"#left",data:{percent:0,level:[]}}),right=new Vue({el:"#right",data:{buttons:[]},methods:{cgmk:function(e){app.model=e,app.code_id=null,app.codecontent="#没有代码",app.codesearch="",app.code_flag=!0}}}),app=new Vue({el:"#app",data:{codecontent:"#没有代码",code_type:"",code_id:"",code_title:"",code_flag:!0,tasksearch:"",visible:!1,jilian:!1,write_val:"1",write_name:"",write:"",model:"task",codesearch:"",taskli:[{date:"2016-12-14",lidata:[]}],codename:[]},filters:{marked:marked},methods:{update:function(e){this.input=e.target.value},change:function(e){this.jilian=e},show:function(){this.visible=!0},getcn:function(e){alert(e)},format:function(e,t){var a=e.length-1,o=t[a]||!1;return o&&o.code?(this.codesearch!==o.code&&this.code_flag&&(portsfun.getcode(o.value,"2"),this.codesearch=o.label),e[a]):void 0},code_chang:function(){this.write=this.codecontent,this.write_val=this.code_type,this.write_name=this.code_title,this.model="write"},code_delete:function(){if(this.code_id){var e=this;portsfun.delcode({id:e.code_id,callback:function(){e.code_id=null,e.codesearch="",e.code_flag=!1,e.codecontent="#没有代码",e.model="write",e.model="code",portsfun.getcodename(),e.$Message.success("删除成功")}})}else this.$Message.error("请选择代码片段")},write_sub:function(){if(this.write_name)if(this.write){var e=this;this.$Modal.confirm({title:"确定要提交到代码库吗？",loading:!0,content:"提交的代码片段可以在代码库模块中查询……",onOk:function(){portsfun.putcode({code_id:e.code_id,write:e.write,write_val:e.write_val,write_name:e.write_name,callback:function(){e.$Modal.remove(),e.write="",e.write_val="1",e.write_name="",portsfun.getcodename(),e.$Message.success("提交成功")}})}})}else this.$Message.error("请填写内容");else this.$Message.error("请填写名称")}}});document.onkeydown=function(e){var t=e||window.event||arguments.callee.caller.arguments[0];if(t&&13==t.keyCode&&"task"===app.model){console.log(app.tasksearch);var a={name:app.tasksearch};app.taskli[0].lidata.push(a),app.tasksearch=""}};var portsfun=function(){var e=function(e){ajax("index-putcode.html",{id:e.code_id,type:e.write_val,content:e.write,title:e.write_name},function(t){var a=JSON.stringify(t);console.log(a),"0"===t.errcode?e.callback():this.$Message.error(t.errmsg)})},t=function(e){ajax("index-delcode.html",{id:e.id},function(t){var a=JSON.stringify(t);console.log(a),e.callback()})},a=function(){ajax("index-codename.html",{},function(e){app.codename=e.data;var t=JSON.stringify(e);console.log(t)})},o=function(){ajax("/js/data/buttons.json",{},function(e){right.buttons=e.data})},n=function(){ajax("index-level.html",{},function(e){left.level=e.data;var t=JSON.stringify(e);console.log(t)})},i=function(e,t){ajax("index-code.html",{id:e,flag:t},function(e){app.codecontent=e.data[0].content,app.code_type=e.data[0].type,app.code_id=e.data[0].id,app.code_title=e.data[0].title;var t=JSON.stringify(e.data[0]);console.log(t)})};return{getbuttonsdata:o,getleveldata:n,getcode:i,getcodename:a,putcode:e,delcode:t}}();$(function(){portsfun.getbuttonsdata(),portsfun.getleveldata(),portsfun.getcodename()});